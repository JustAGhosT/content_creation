(()=>{var e={};e.id=611,e.ids=[611],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3847:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>m,lu:()=>f});var n=r(29021),s=r.n(n),i=r(33873),a=r.n(i),o=r(21820),u=r.n(o);class c{async acquire(){return new Promise(e=>{this.locked?this.waitQueue.push(e):(this.locked=!0,e())})}release(){if(this.waitQueue.length>0){let e=this.waitQueue.shift();e&&e()}else this.locked=!1}constructor(){this.locked=!1,this.waitQueue=[]}}let l=new c,p="undefined"!=typeof process&&process.cwd?a().join(process.cwd(),"data","feature-flags.json"):"",d={textParser:{enabled:!0,implementation:"openai"},imageGeneration:!0,summarization:!0,platformConnectors:!0,multiPlatformPublishing:!0,notificationSystem:!0,feedbackMechanism:!0,airtableIntegration:!0};async function f(){await l.acquire();try{if(p){let e=a().dirname(p);s().existsSync(e)||s().mkdirSync(e,{recursive:!0});let t=a().join(u().tmpdir(),`feature-flags-${Date.now()}-${Math.random().toString(36).substring(2)}.json`);s().writeFileSync(t,JSON.stringify(d,null,2),"utf8"),s().renameSync(t,p)}}finally{l.release()}}try{let e=function(){if(p&&s().existsSync(p))try{let e=s().readFileSync(p,"utf8");return{...d,...JSON.parse(e)}}catch(e){console.error("Failed to load feature flags from file:",e)}return d}();Object.assign(d,e)}catch(e){console.error("Error loading feature flags:",e)}let m=d},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:e=>{"use strict";e.exports=require("assert")},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29039:(e,t,r)=>{"use strict";r.d(t,{LR:()=>i,hn:()=>s});var n=r(44999);async function s(e,t,r,s){let i=await (0,n.b3)(),a=i.get("x-invoke-path")||"unknown",o=i.get("x-http-method")||"unknown";return{action:e,user:i.get("x-user-id")||"anonymous",timestamp:new Date().toISOString(),path:a,method:o,body:t?function e(t){if(!t)return t;let r=["password","token","apiKey","secret","authorization"],n={...t};for(let[t,s]of Object.entries(n)){let i=t.toLowerCase();if(r.some(e=>i.includes(e))){n[t]="[REDACTED]";continue}"object"==typeof s&&null!==s&&(n[t]=e(s))}return n}(t):void 0,result:r,statusCode:s}}async function i(e){try{await fetch("/api/internal/audit-log",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(t){console.error("[AUDIT SERVICE ERROR]",t),console.log("[AUDIT FALLBACK]",JSON.stringify(e))}}},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},35345:(e,t,r)=>{"use strict";r.d(t,{I:()=>i,Uj:()=>a});var n=r(32190);function s(e,t=500,r,i){let a={message:e};return r&&(a.details=r),i&&(a.code=i),n.NextResponse.json(a,{status:t})}let i={badRequest:(e="Bad request",t)=>s(e,400,t,"BAD_REQUEST"),unauthorized:(e="Unauthorized",t)=>s(e,401,t,"UNAUTHORIZED"),forbidden:(e="Forbidden",t)=>s(e,403,t,"FORBIDDEN"),notFound:(e="Not found",t)=>s(e,404,t,"NOT_FOUND"),methodNotAllowed:(e="Method not allowed",t)=>s(e,405,t,"METHOD_NOT_ALLOWED"),conflict:(e="Conflict",t)=>s(e,409,t,"CONFLICT"),internalServerError:(e="Internal server error",t)=>s(e,500,t,"INTERNAL_SERVER_ERROR")};function a(e){return async(t,r)=>{try{return await e(t,r)}catch(e){if(console.error("API Error:",{error:e,timestamp:new Date().toISOString(),url:t?.url||"unknown",method:t?.method||"unknown"}),"ValidationError"===e.name)return i.badRequest("Validation error",e.details);return i.internalServerError(e.message||"An unexpected error occurred",e.cause)}}}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},69580:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>I,routeModule:()=>h,serverHooks:()=>E,workAsyncStorage:()=>x,workUnitAsyncStorage:()=>A});var n={};r.r(n),r.d(n,{POST:()=>m,PUT:()=>y});var s=r(96559),i=r(48088),a=r(37719),o=r(94612),u=r(32190),c=r(29039),l=r(99708),p=r(35345),d=r(3847);let f=()=>({deepseek:process.env.DEEPSEEK_API_ENDPOINT,openai:process.env.OPENAI_API_ENDPOINT,azure:process.env.AZURE_CONTENT_API_ENDPOINT}),m=(0,p.Uj)(async e=>{if(!(0,l.wR)())return p.I.unauthorized("Authentication required to parse text");if(!d.Ay.textParser?.enabled)return p.I.forbidden("Text parser feature is disabled");if(!function(){let e=["DEEPSEEK_API_ENDPOINT","OPENAI_API_ENDPOINT","AZURE_CONTENT_API_ENDPOINT"].filter(e=>!process.env[e]);return!(e.length>0)||(console.error(`Missing required environment variables: ${e.join(", ")}`),!1)}())return p.I.internalServerError("Text parser service is not properly configured");try{let t,{rawInput:r}=await e.json();if(!r||"string"!=typeof r)return p.I.badRequest("Invalid input: rawInput must be a non-empty string");if(r.length>1e6)return p.I.badRequest("Input too large",{maxSize:1e6,actualSize:r.length});let n=await (0,c.hn)("PARSE_TEXT",{inputLength:r.length});await (0,c.LR)(n);try{t=JSON.parse(r)}catch(e){return p.I.badRequest("Invalid JSON input")}let s=f(),i=d.Ay.textParser.implementation,a={deepseek:s.deepseek,openai:s.openai,azure:s.azure}[i];if(!a)return p.I.badRequest("Invalid text parser implementation");let l=await o.A.post(a,{data:t}),m=await (0,c.hn)("PARSE_TEXT_SUCCESS",{implementation:i});return await (0,c.LR)(m),u.NextResponse.json(l.data)}catch(n){console.error("Parse error:",n);let e=500,t="Failed to parse text";o.A.isAxiosError(n)&&n.response?(e=n.response.status||500,t=n.response.data?.error||n.response.statusText||t):o.A.isAxiosError(n)&&n.request?t="No response received from upstream service":n instanceof Error&&(t=n.message);let r=await (0,c.hn)("PARSE_TEXT_FAILURE",{error:t,implementation:d.Ay.textParser.implementation});if(await (0,c.LR)(r),400===e)return p.I.badRequest(t,{service:d.Ay.textParser.implementation});if(401===e)return p.I.unauthorized(t,{service:d.Ay.textParser.implementation});if(403===e)return p.I.forbidden(t,{service:d.Ay.textParser.implementation});else if(404===e)return p.I.notFound(t,{service:d.Ay.textParser.implementation});else return p.I.internalServerError(t,{service:d.Ay.textParser.implementation})}}),y=(0,p.Uj)(async e=>{if(!(0,l.wR)())return p.I.unauthorized("Authentication required to analyze text");try{let{parsedData:t}=await e.json();if(!t||"object"!=typeof t||Array.isArray(t))return p.I.badRequest("Invalid input: parsedData must be a non-empty object");let r=await (0,c.hn)("ANALYZE_PARSED_DATA",{keyCount:Object.keys(t).length});await (0,c.LR)(r);let n=Object.keys(t).length,s={};for(let[e,r]of Object.entries(t))s[e]=Array.isArray(r)?"array":typeof r;return u.NextResponse.json({keyCount:n,valueTypes:s})}catch(t){console.error("Analysis error:",t);let e=await (0,c.hn)("ANALYZE_PARSED_DATA_FAILURE",{error:t.message});return await (0,c.LR)(e),p.I.internalServerError("Failed to analyze text",{service:d.Ay?.textParser?.implementation})}}),h=new s.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/parse/route",pathname:"/api/parse",filename:"route",bundlePath:"app/api/parse/route"},resolvedPagePath:"C:\\Dev\\PhoenixVC\\content_creation\\app\\api\\parse\\route.ts",nextConfigOutput:"",userland:n}),{workAsyncStorage:x,workUnitAsyncStorage:A,serverHooks:E}=h;function I(){return(0,a.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:A})}},74075:e=>{"use strict";e.exports=require("zlib")},78335:()=>{},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},83997:e=>{"use strict";e.exports=require("tty")},94735:e=>{"use strict";e.exports=require("events")},96487:()=>{},99708:(e,t,r)=>{"use strict";r.d(t,{qc:()=>i,wR:()=>s});var n=r(44999);async function s(){return!!(await (0,n.b3)()).get("x-user-id")}async function i(){return"admin"===(await (0,n.b3)()).get("x-user-role")}r(32190)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[360,658,612],()=>r(69580));module.exports=n})();