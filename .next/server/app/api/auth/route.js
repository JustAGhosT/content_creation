(()=>{var e={};e.id=188,e.ids=[188],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29039:(e,r,t)=>{"use strict";t.d(r,{LR:()=>a,hn:()=>s});var n=t(44999);async function s(e,r,t,s){let a=await (0,n.b3)(),o=a.get("x-invoke-path")||"unknown",i=a.get("x-http-method")||"unknown";return{action:e,user:a.get("x-user-id")||"anonymous",timestamp:new Date().toISOString(),path:o,method:i,body:r?function e(r){if(!r)return r;let t=["password","token","apiKey","secret","authorization"],n={...r};for(let[r,s]of Object.entries(n)){let a=r.toLowerCase();if(t.some(e=>a.includes(e))){n[r]="[REDACTED]";continue}"object"==typeof s&&null!==s&&(n[r]=e(s))}return n}(r):void 0,result:t,statusCode:s}}async function a(e){try{await fetch("/api/internal/audit-log",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(r){console.error("[AUDIT SERVICE ERROR]",r),console.log("[AUDIT FALLBACK]",JSON.stringify(e))}}},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},34072:e=>{function r(e,r,t,n){return Math.round(e/t)+" "+n+(r>=1.5*t?"s":"")}e.exports=function(e,t){t=t||{};var n,s,a,o,i=typeof e;if("string"===i&&e.length>0){var u=e;if(!((u=String(u)).length>100)){var c=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(u);if(c){var d=parseFloat(c[1]);switch((c[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*d;case"weeks":case"week":case"w":return 6048e5*d;case"days":case"day":case"d":return 864e5*d;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*d;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*d;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*d;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return d;default:break}}}return}if("number"===i&&isFinite(e)){return t.long?(s=Math.abs(n=e))>=864e5?r(n,s,864e5,"day"):s>=36e5?r(n,s,36e5,"hour"):s>=6e4?r(n,s,6e4,"minute"):s>=1e3?r(n,s,1e3,"second"):n+" ms":(o=Math.abs(a=e))>=864e5?Math.round(a/864e5)+"d":o>=36e5?Math.round(a/36e5)+"h":o>=6e4?Math.round(a/6e4)+"m":o>=1e3?Math.round(a/1e3)+"s":a+"ms"}throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},35345:(e,r,t)=>{"use strict";t.d(r,{I:()=>a,Uj:()=>o});var n=t(32190);function s(e,r=500,t,a){let o={message:e};return t&&(o.details=t),a&&(o.code=a),n.NextResponse.json(o,{status:r})}let a={badRequest:(e="Bad request",r)=>s(e,400,r,"BAD_REQUEST"),unauthorized:(e="Unauthorized",r)=>s(e,401,r,"UNAUTHORIZED"),forbidden:(e="Forbidden",r)=>s(e,403,r,"FORBIDDEN"),notFound:(e="Not found",r)=>s(e,404,r,"NOT_FOUND"),methodNotAllowed:(e="Method not allowed",r)=>s(e,405,r,"METHOD_NOT_ALLOWED"),conflict:(e="Conflict",r)=>s(e,409,r,"CONFLICT"),internalServerError:(e="Internal server error",r)=>s(e,500,r,"INTERNAL_SERVER_ERROR")};function o(e){return async(r,t)=>{try{return await e(r,t)}catch(e){if(console.error("API Error:",{error:e,timestamp:new Date().toISOString(),url:r?.url||"unknown",method:r?.method||"unknown"}),"ValidationError"===e.name)return a.badRequest("Validation error",e.details);return a.internalServerError(e.message||"An unexpected error occurred",e.cause)}}}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},80570:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>A,routeModule:()=>O,serverHooks:()=>S,workAsyncStorage:()=>b,workUnitAsyncStorage:()=>L});var n={};t.r(n),t.d(n,{DELETE:()=>I,POST:()=>R});var s=t(96559),a=t(48088),o=t(37719),i=t(43205),u=t.n(i),c=t(44999),d=t(32190),l=t(29039),p=t(35345),m=t(94501);let h=[{id:"1",username:"admin",password:"admin123",role:"admin"},{id:"2",username:"user",password:"user123",role:"user"}];async function f(e){return h.find(r=>r.username===e)}async function y(e,r){let t=h.find(r=>r.username===e);return!!t&&t.password===r}async function w(e,r){let t=(0,m.oI)(e,"Username");if(t)return p.I.badRequest(t);let n=(0,m.oI)(r,"Password");return n?p.I.badRequest(n):null}async function g(e,r){await (0,l.LR)(await (0,l.hn)("LOGIN_ATTEMPT",{username:e}));let t=await f(e);return t?await y(e,r)?t:(await (0,l.LR)(await (0,l.hn)("LOGIN_FAILED",{username:e,reason:"Invalid password"})),p.I.unauthorized("Invalid username or password")):(await (0,l.LR)(await (0,l.hn)("LOGIN_FAILED",{username:e,reason:"User not found"})),p.I.unauthorized("Invalid username or password"))}async function v(e){(await (0,c.UL)()).set({name:"auth-token",value:e,httpOnly:!0,secure:!0,sameSite:"strict",maxAge:3600,path:"/"})}async function x(e){try{let{username:r,password:t}=await e.json(),n=await w(r,t);if(n)return n;let s=await g(r,t);if(s instanceof d.NextResponse)return s;let a=u().sign({id:s.id,role:s.role,username:s.username,iat:Math.floor(Date.now()/1e3)},function(){let e=process.env.JWT_SECRET;if(!e)throw Error("JWT_SECRET environment variable is not set");return e}(),{expiresIn:"1h"});return await v(a),await (0,l.LR)(await (0,l.hn)("LOGIN_SUCCESS",{username:r,userId:s.id})),d.NextResponse.json({token:a,user:{id:s.id,username:s.username,role:s.role}})}catch(e){return console.error("Login error:",e),p.I.internalServerError("An error occurred during login")}}async function E(){try{return(await (0,c.UL)()).set({name:"auth-token",value:"",httpOnly:!0,secure:!0,sameSite:"strict",maxAge:0,path:"/"}),await (0,l.LR)(await (0,l.hn)("LOGOUT")),d.NextResponse.json({message:"Logged out successfully"})}catch(e){return console.error("Logout error:",e),p.I.internalServerError("An error occurred during logout")}}let R=(0,p.Uj)(async e=>x(e)),I=(0,p.Uj)(async e=>E()),O=new s.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/auth/route",pathname:"/api/auth",filename:"route",bundlePath:"app/api/auth/route"},resolvedPagePath:"C:\\Dev\\PhoenixVC\\content_creation\\app\\api\\auth\\route.ts",nextConfigOutput:"",userland:n}),{workAsyncStorage:b,workUnitAsyncStorage:L,serverHooks:S}=O;function A(){return(0,o.patchFetch)({workAsyncStorage:b,workUnitAsyncStorage:L})}},94501:(e,r,t)=>{"use strict";function n(e,r){return null==e?`${r} is required`:"string"!=typeof e?`${r} must be a string`:""===e.trim()?`${r} cannot be empty`:void 0}function s(e,r){return null==e?`${r} is required`:Array.isArray(e)?void 0:`${r} must be an array`}function a(e,r,t){return null==e?`${t} is required`:r.some(r=>r===e)?void 0:`${t} must be one of: ${r.join(", ")}`}function o(e,r){let t={};for(let[n,s]of Object.entries(r)){let r=s(e[n]);r&&(t[n]=r)}return Object.keys(t).length>0?t:null}function i(e,r){let t=Object.keys(e).filter(e=>!r.includes(e));return t.length>0?t:null}t.d(r,{I1:()=>s,Q5:()=>o,SW:()=>i,i1:()=>a,oI:()=>n})},96487:()=>{}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[360,205],()=>t(80570));module.exports=n})();